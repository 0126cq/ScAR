"function _validatePurchaseRequestWithAmount(bytes32 message, bytes calldata signature, string calldata nonce, uint16 amount) internal virtual {        bytes32 nonceBytes32 = _getNonceBytes32(nonce);        require(!_usedNonces[nonceBytes32], \"Cannot replay transaction\");        bytes32 expectedMessage = keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n\", (20+bytes(nonce).length+bytes(uint256(amount).toString()).length).<mask0>, msg.sender, nonce, uint256(amount).toString()));        require(message == expectedMessage, \"Malformed message\");        address signer = message.recover(signature);        require(signer == _signingAddress, \"Invalid signature\");        _usedNonces[nonceBytes32] = true;    }"