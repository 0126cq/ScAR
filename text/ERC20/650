"function handleReferralWithERC20(        address buyer,        uint256 amount,        bytes memory referral,        address payable destination,        address tokenAddress    ) internal {        ERC20 token = <mask0>;        uint256 amountForDestination = amount;        if (referral.length > 0) {            (bytes memory signature, address referrer, address referee, uint256 expiryTime, uint256 commissionRate) = decodeReferral(referral);            uint256 commission = 0;            if (isReferralValid(signature, referrer, referee, expiryTime, commissionRate)) {                commission = SafeMathWithRequire.div(SafeMathWithRequire.mul(amount, commissionRate), 10000);                emit ReferralUsed(referrer, referee, tokenAddress, amount, commission, commissionRate);                amountForDestination = SafeMathWithRequire.sub(amountForDestination, commission);            }            if (commission > 0) {                require(token.transferFrom(buyer, referrer, commission), \"commision transfer failed\");            }        }        require(token.transferFrom(buyer, destination, amountForDestination), \"payment transfer failed\");    }"