"function buy() payable onlyNotOwner thresholdAll returns (uint256 amount) {        amount = 0;        uint remain = msg.value / _originalBuyPrice;        while (remain > 0 && _level < 3) {             remain = remain * ratio[_level] / ratio[_level+1];            if (_icoSupply <= remain + threshold[_level]) {                remain = (remain + threshold[_level] - _icoSupply) * ratio[_level+1] / ratio[_level];                amount += _icoSupply - threshold[_level];                _icoSupply = threshold[_level];                _level += 1;            }            else {                _icoSupply -= remain;                amount += remain;                remain = 0;                break;            }        }        if (balances[owner] < amount)            revert();        if (remain > 0) {            remain *= _originalBuyPrice;            msg.sender.transfer(remain);        }        balances[owner] -= amount;        balances[msg.sender] += amount;        owner.transfer(msg.value - remain);        <mask0>;        return amount;    }"