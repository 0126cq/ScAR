"function buy(    bytes32 saleId,    uint256 tokenQuantity,    bytes32[] calldata proof  ) public validSale(saleId) requireOpen(saleId) canAccessSale(saleId, proof) nonReentrant {    require(      tokenQuantity + sales[saleId].spent[msg.sender] <= sales[saleId].userBuyLimit,      \"purchase exceeds your limit\"    );    require(      tokenQuantity + sales[saleId].totalSpent <= sales[saleId].saleBuyLimit,      \"purchase exceeds sale limit\"    );    require(paymentToken.allowance(msg.sender, address(this)) >= tokenQuantity, \"allowance too low\");    paymentToken.<mask0>;    sales[saleId].spent[msg.sender] += tokenQuantity;    sales[saleId].totalSpent += tokenQuantity;    totalSpent += tokenQuantity;    emit Buy(saleId, msg.sender, tokenQuantity, false, proof);  }"