"function tokenFallback(address from, uint value, bytes calldata _data) external{\t\t\tif(msg.sender == address(Resolve) ){\t\t\tif(wishes == 0){\t\t\t\twishes += value / 1e16; \t\t\t\tGENIE = from;\t\t\t\tif(GENIE_generation % 6 == 0){\t\t\t\t\tuint earnings = PiZZa.resolveEarnings( THIS );\t\t\t\t\tif(earnings > 0){\t\t\t\t\t\tPiZZa.<mask0>;\t\t\t\t\t\t(bool success, ) = APPARITION.call{value:earnings}(\"\");\t\t\t\t\t\trequire(success, \"Transfer failed.\");\t\t\t\t\t}\t\t\t\t}\t\t\t\tGENIE_generation += 1;\t\t\t\temit RechargeMagicLamp(from, wishes);\t\t\t}else{\t\t\t\trevert(\"only when there is 0 wishes\");\t\t\t}\t\t}else{\t\t\tif( msg.sender == address(Rugs) ){\t\t\t\trequire( value > 0 );\t\t\t\tuint rugMagic = value;\t\t\t\tif(from == CarpetRider){\t\t\t\t\tif(APPARITION != GENIE && CarpetRider != GENIE){\t\t\t\t\t\trugMagic = rugMagic / 1e18;\t\t\t\t\t\tif(rugMagic >= wishes){\t\t\t\t\t\t\tif(wishes>0){\t\t\t\t\t\t\t\twishes = 0;\t\t\t\t\t\t\t\tuint soulecules = Resolve.balanceOf(THIS)/2;\t\t\t\t\t\t\t\tif (soulecules>0) Resolve.transfer( address(PiZZa), soulecules);\t\t\t\t\t\t\t\tResolve.transfer( CarpetRider, soulecules );\t\t\t\t\t\t\t\temit KillGenie(CarpetRider, GENIE);\t\t\t\t\t\t\t}else{\t\t\t\t\t\t\t\trevert(\"they're already dead.\");\t\t\t\t\t\t\t}\t\t\t\t\t\t}else{\t\t\t\t\t\t\twishes -= rugMagic;\t\t\t\t\t\t\temit DamageGenie(CarpetRider, GENIE, rugMagic);\t\t\t\t\t\t}\t\t\t\t\t}else{\t\t\t\t\t}\t\t\t\t}else{\t\t\t\t\tuint damage = rugMagic;\t\t\t\t\tif( CarpetRiderHP <= damage ){\t\t\t\t\t\tCarpetRider = from;\t\t\t\t\t\t\tCarpetRiderHP = weight(from);\t\t\t\t\t\temit RugPulled(from, CarpetRider, CarpetRiderHP, true);\t\t\t\t\t}else{\t\t\t\t\t\tif(damage>0){\t\t\t\t\t\t\tCarpetRiderHP -= damage;\t\t\t\t\t\t\temit Damaged( CarpetRider, damage, true );\t\t\t\t\t\t}\t\t\t\t\t}\t\t\t\t}\t\t\t}else{\t\t\t\trevert(\"no want\");\t\t\t}\t\t}\t}"