"function verifySig(bytes32 tosignh, bytes dersig, bytes pubkey) internal returns (bool){        bool sigok;        address signer;        bytes32 sigr;        bytes32 sigs;        bytes memory sigr_ = new bytes(32);        uint offset = 4+(uint(dersig[3]) - 0x20);        sigr_ = copyBytes(dersig, offset, 32, sigr_, 0);        bytes memory sigs_ = new bytes(32);        offset += 32 + 2;        sigs_ = copyBytes(dersig, offset+(uint(dersig[offset-1]) - 0x20), 32, sigs_, 0);        assembly {            sigr := mload(add(sigr_, 32))            sigs := mload(add(sigs_, 32))        }        (sigok, signer) = safer_ecrecover(tosignh, 27, sigr, sigs);        if (address(<mask0>) == signer) return true;        else {            (sigok, signer) = safer_ecrecover(tosignh, 28, sigr, sigs);            return (address(keccak256(pubkey)) == signer);        }    }"